# infra-lite — Supported Features

本文档描述 **infra-lite** 当前版本已稳定支持的核心能力。  
该列表关注“能力边界”，而非具体用法或实现细节。

API 说明、设计推导及扩展示例将随版本逐步补充。

---

## Overview

infra-lite 是一组 **轻量级、可嵌入、可组合** 的 C / C++ 基础设施组件，  
强调：

- 明确的行为边界
- 可预测的控制流
- 长期可维护性

---

## Parsing Model

infra-lite 提供一套极简的解析模型，适用于配置解析、小型 DSL、表达式求值等场景。

已支持能力包括：

- 基于 `const char*` 的输入模型
- 显式输入消费（无隐式回溯）
- 无动态内存分配
- 可用于 header-only 集成

解析逻辑与求值逻辑可同步完成，不强制构建 AST。

---

## Parse Result & Error Model

infra-lite 使用统一的解析结果与错误表达模型。

核心特性：

- 明确区分 **成功 / 失败**
- 错误位置通过指针精确定位
- Parser 不做全局成功假设或尾部校验

当前已定义的错误类型：

- `None`
- `UnexpectedChar`
- `UnexpectedEnd`

错误模型不依赖异常机制，适合系统级与嵌入式环境。

---

## Parser Contract

Parser 以函数形式定义，并遵循统一契约：

- 成功时返回：
  - 解析值
  - 下一个未消费的输入位置
- 失败时返回：
  - 错误类型
  - 错误发生位置

Parser 本身不负责：

- 跳过多余输入
- 自动处理空白
- 隐式错误恢复

该契约支持手写解析器与组合式解析。

---

## Operator Chaining

infra-lite 提供运算符链式解析工具，用于表达常见的表达式结合关系。

### Left-Associative Chaining

适用于：

- 加减
- 乘除
- 其他左结合语义

特性：

- 明确的解析顺序
- 运算规则通过回调函数注入
- 不引入中间 AST 结构

### Right-Associative Chaining

适用于：

- 幂运算
- 赋值语义
- 其他右结合语法

特性：

- 递归构建结合关系
- 行为可预测
- 与左结合模型风格一致

---

## Control Utilities

infra-lite 提供一组用于**精确控制解析流程**的基础工具。

### Whitespace Handling

- 支持空格、制表符、换行符
- 由调用方显式决定何处跳过空白
- Parser 内部不隐式处理空白，避免语义歧义

### Optional Parsing

用于表达“可存在也可不存在”的语法结构。

特性：

- 失败不传播错误
- 不消费输入
- 由调用方显式判断是否命中

### Lookahead

用于在不消费输入的前提下判断后续输入形态。

特性：

- 仅用于条件判断
- 永不推进输入指针
- 不产生解析值

### Character Expectation

提供单字符级别的语法约束能力。

特性：

- 校验期望字符
- 成功时消费输入
- 失败时返回精确错误位置

---

## Composition & Predictability

infra-lite 强调：

- Parser 可自由组合
- 所有输入消费行为都是显式的
- 不存在隐式回溯或隐藏状态

解析流程应当：

- 易于推理
- 易于调试
- 行为稳定可预测

---

## Design Constraints

infra-lite 明确遵循以下约束：

- 不引入完整解析框架
- 不提供自动错误恢复
- 不依赖 STL 容器或异常
- 不追求语法覆盖率最大化

其目标是提供**稳定、低阶、可组合的解析原语**，  
而非一站式解析解决方案。

---

## Roadmap

未来版本可能包含：

- 更细粒度的错误分类
- 更高阶的 Parser 组合工具
- 使用模式与示例文档
- 更复杂语法的参考实现

（该列表将随能力演进持续更新）
